<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
define(["jquery","core/ajax","core/notification","core/str","core/url","core/modal_factory","core/modal_events","core/templates"],function(g,c,e,f,b,a,h,d){return{debug:0,modal:undefined,screenshot:"",screenshotname:"",triggerSteps:0,assignSupporter:function(j){var i=this;if(i.debug>0){console.log("local_edusupport/main:assignSupporter(discussionid, userid)",j,userid)}c.call([{methodname:"local_edusupport_get_potentialsupporters",args:{discussionid:j},done:function(m){try{m=JSON.parse(m)}catch(p){}if(i.debug>0){console.log("local_edusupport_external:local_edusupport_get_potentialsupporters",m)}var q=Object.keys(m.supporters);var l='<input type="hidden" value="'+j+'" />';l+="<select>";for(var n=0;n<q.length;n++){l+='<optgroup label="'+q[n]+'">';for(var k=0;k<m.supporters[q[n]].length;k++){var o=m.supporters[q[n]][k];l+='<option value="'+o.userid+'"'+((o.selected)?' selected="selected"':"")+">"+o.firstname+" "+o.lastname+"</option>"}l+="</optgroup>"}l+="</select>";a.create({title:f.get_string("select","core"),type:a.types.SAVE_CANCEL,body:l,}).done(function(r){console.log("Created modal");r.show();r.getRoot().on(h.save,function(u){u.preventDefault();var v=g(this).find(".modal-body input").val();var s=g(this).find(".modal-body select").val();var t={discussionid:v,supporterid:s};c.call([{methodname:"local_edusupport_set_currentsupporter",args:t,done:function(w){console.log(w);if(w==1){top.location.reload()}else{alert("Error: "+w)}},fail:e.exception}])})})},fail:e.exception}])},checkHasScreenshot:function(j){var i=this;if(i.debug>0){console.log("local_edusupport/main:checkHasScreenshot(c)",j)}if(g(j).closest("form").find("#screenshot").attr("src")==""){g(j).closest("form").find("#screenshot_ok").css("display","block")}else{g(j).closest("form").find("#screenshot_ok").css("display","none");g(j).closest("form").find("#screenshot").css("display",(g(j).is(":checked")?"inline":"none"));g(j).closest("form").find("#screenshot_new").css("display",(g(j).is(":checked")?"block":"none"))}},generateScreenshot:function(i){MAIN.modal.hide();require(["local_edusupport/html2canvas"],function(j){console.log("Making screenshot");j(document.body).then(function(k){console.log("Got screenshot");MAIN.canvas=k;if(typeof MAIN.modal!=="undefined"){MAIN.prepareScreenshot(i);MAIN.modal.show()}})})},injectHelpButton:function(i){var j=this;if(j.debug>0){console.log("local_edusupport/main:injectHelpButton(supportmenu)")}g(i).insertBefore(g(".nav .usermenu"))},injectReplyButtons:function(i){f.get_strings([{key:"reply",component:"forum"},]).done(function(j){g('a[href*="issue.php?discussion='+i+'&parent="]').remove();g('a[href*="issue.php?discussion='+i+'&delete="]').remove();g('a[href*="post.php?prune="]').remove();g(".forum-post-container>.forumpost").each(function(){var k=g(this).attr("data-post-id");if(g(this).find(".reply-"+k).length==0){g(this).find(".post-actions:first-child").append(g('<a data-region="post-action" class="btn btn-link reply-'+k+'" title="'+j[0]+'" aria-label="'+j[0]+'" role="menuitem" tabindex="-1">').html(j[0]).attr("href",b.relativeUrl("/local/edusupport/issue.php?discussion="+i+"&replyto="+k)))}})}).fail(e.exception)},closeIssue:function(i){console.log("closeIssue(discussionid)",i);c.call([{methodname:"local_edusupport_close_issue",args:{discussionid:i},done:function(j){console.log(j);if(j==1){top.location.href=b.relativeUrl("/local/edusupport/issues.php",{})}else{e.exception(j)}},fail:e.exception}])},faqtoogle:function(){if(g("input#id_faqread:not(.autochecked)").length){g("#create_issue_input").toggle();g("#local_edusupport_create_form .fdescription.required").toggle();g("input#id_faqread").click(function(){g("#create_issue_input").toggle();g("#local_edusupport_create_form .fdescription.required").toggle()})}},injectForwardButton:function(k,j,i){if(this.debug){console.log("local_edusupport/main:injectForwardButton(discussionid, isissue)",k,j)}if(typeof k==="undefined"){return}f.get_strings([{key:(typeof j!=="undefined"&&j)?"issue_revoke":"issue_assign_nextlevel",component:"local_edusupport",param:{sitename:i,}},]).done(function(l){g('#page-content div[role="main"] .discussionname').parent().prepend(g('<a href="#">').attr("onclick","require(['local_edusupport/main'], function(MAIN) { MAIN.injectForwardModal("+k+", "+j+", '"+i+"'); }); return false;").attr("style","float: right").addClass("btn btn-primary").html(l[0]))}).fail(e.exception)},injectTest:function(){var i=g(".discussionname");if(i.text().substr(0,2)=="! "){i.addClass("alert-warning")}if(i.text().substr(0,2)=="!!"){i.addClass("alert-danger")}},injectForwardModal:function(k,j,i){f.get_strings([{key:"confirm",component:"core"},{key:(typeof j!=="undefined"&&j)?"issue_revoke":"issue_assign_nextlevel",component:"local_edusupport",param:{sitename:i,}},]).done(function(l){a.create({type:a.types.SAVE_CANCEL,title:l[0],body:l[1],}).done(function(n){var m=n.getRoot();m.on(h.save,function(){top.location.href=b.relativeUrl("/local/edusupport/forward_2nd_level.php",{d:k,revoke:j})});n.show()})}).fail(e.exception)},postBox:function(u){var k=this;if(typeof k.is_sending!=="undefined"&&k.is_sending){console.log("Issue in queue, aborting");return}if(k.debug>0){console.log("MAIN.postBox(modal)",u)}var t=g("#local_edusupport_create_form #id_subject").val();var o=g("#local_edusupport_create_form #id_contactphone").val()||"";console.log(o);var v=g("#local_edusupport_create_form #id_description").val();var l=g("#local_edusupport_create_form #id_forum_group").val();var p=g("#local_edusupport_create_form #id_postto2ndlevel").prop("checked")?1:0;var r=true;var s=k.screenshot;var j=k.screenshotname;var n=g("#local_edusupport_create_form #id_faqread").prop("checked")?1:0;var i=window.location.href;if(n==0){var m=f.get_string("faqread","local_edusupport",{});g.when(m).done(function(w){e.alert("",w)});return}if(t.length<3||v.length<5){var m=f.get_string("be_more_accurate","local_edusupport",{});g.when(m).done(function(w){e.alert("",w)});return}k.is_sending=true;var q=(r&&typeof s!=="undefined")?s:"";if(k.debug>0){console.log("local_edusupport_create_issue",{subject:t,description:v,forum_group:l,postto2ndlevel:p,image:q,url:i})}c.call([{methodname:"local_edusupport_create_issue",args:{subject:t,description:v,forum_group:l,postto2ndlevel:p,image:q,screenshotname:j,url:i,contactphone:o},done:function(w){if(k.debug>0){console.log(w)}u.hide();var x="";if(typeof w.discussionid!=="undefined"&&(parseInt(w.discussionid)==-999||parseInt(w.discussionid)>0)){g("#id_subject, #id_contactphone, #id_description, #edusupport_screenshot>input").val("");g("#edusupport_screenshot>.alert").css("display","none")}if(typeof w.discussionid!=="undefined"&&parseInt(w.discussionid)==-999){f.get_strings([{key:"create_issue_success_title",component:"local_edusupport"},{key:"create_issue_success_description_mail",component:"local_edusupport"},{key:"create_issue_success_responsibles",component:"local_edusupport"},{key:"create_issue_success_close",component:"local_edusupport"},]).done(function(y){var z=y[1];if(x!=""){z=y[2]+x}e.alert(y[0],z,y[3])}).fail(e.exception)}else{if(typeof w.discussionid!=="undefined"&&parseInt(w.discussionid)>0){f.get_strings([{key:"create_issue_success_title",component:"local_edusupport"},{key:"create_issue_success_description",component:"local_edusupport"},{key:"create_issue_success_responsibles",component:"local_edusupport"},{key:"create_issue_success_goto",component:"local_edusupport"},{key:"create_issue_success_close",component:"local_edusupport"},]).done(function(y){var z=y[1];if(x!=""){z=y[2]+x}e.confirm(y[0],z,y[3],y[4],function(){location.href=b.fileUrl("/mod/forum","discuss.php?d="+w.discussionid)})}).fail(e.exception)}else{f.get_strings([{key:"create_issue_error_title",component:"local_edusupport"},{key:"create_issue_error_description",component:"local_edusupport"},]).done(function(y){e.alert(y[0],y[1])}).fail(e.exception)}}k.is_sending=false},fail:e.exception}])},prepareBox:function(){var k=this;if(k.debug>0){console.log("Showing modal")}var i=g(k.modal.body);if(i.find("#id_forum_group>option").length<=1){i.find("#id_forum_group").parent().parent().css("display","none")}k.modal.setLarge();k.modal.getRoot().on(h.save,function(l){k.postBox(k.modal);l.preventDefault()});var j=f.get_string("send","local_edusupport",{});g.when(j).done(function(l){k.modal.setSaveButtonText(l)});k.modal.show()},prepareScreenshot:function(l){var k=this;var j=k.canvas.toDataURL();var i=g(k.modal.body);i.find("img#screenshot").attr("src",j);g("#screenshot").closest("div").css("display",undefined);g("#id_postscreenshot").closest("div.fitem").css("display",undefined);k.checkHasScreenshot(g("#id_postscreenshot"));delete (k.canvas)},showBox:function(j){if(typeof j==="undefined"){j=0}var i=this;delete (i.canvas);if(typeof i.modal!=="undefined"){i.prepareBox(j)}else{console.log("Fetching modal");i.triggerSpinner(1);c.call([{methodname:"local_edusupport_create_form",args:{url:window.location.href,image:"",forumid:j},done:function(k){console.log("Got modal");i.triggerSpinner(-1);g("#local_edusupport_create_form").remove();a.create({type:a.types.SAVE_CANCEL,body:k,large:1,}).done(function(l){console.log("Created modal");i.modal=l;i.prepareBox();i.faqtoogle()})},fail:e.exception}])}},showSupporter:function(j){if(typeof j==="undefined"){j=0}var i=this;delete (i.canvas);if(typeof i.modal!=="undefined"){i.prepareBox(j)}else{console.log("Fetching modal");i.triggerSpinner(1);c.call([{methodname:"local_edusupport_create_form",args:{url:top.location.href,image:"",forumid:j},done:function(k){console.log("Got modal");i.triggerSpinner(-1);g("#local_edusupport_create_form").remove();a.create({type:a.types.SAVE_CANCEL,body:k,large:1,}).done(function(l){console.log("Created modal");i.modal=l;i.prepareBox()})},fail:e.exception}])}},supportCourseMovedAlert:function(j,i){a.create({title:j,type:a.types.OK,body:i,}).done(function(k){k.show()})},triggerSpinner:function(i){MAIN=this;MAIN.triggerSteps+=i;if(MAIN.triggerSteps>0){if(g("body #edusupport-spinner").length==0){g("body").append(g('<div id="edusupport-spinner" class="spinner-grid show"><div></div><div></div><div></div><div></div></div>'))}}else{g("#edusupport-spinner").remove()}},uploadScreenshot:function(){MAIN=this;g("#edusupport_screenshot input").addClass("disabled");g("#edusupport_screenshot div.alert").addClass("hidden");var j=document.querySelector('#edusupport_screenshot input[type="file"]').files[0];var i=new FileReader();i.readAsDataURL(j);if(typeof j.name!=="undefined"){MAIN.screenshotname=j.name;i.onload=function(){g("#edusupport_screenshot div.alert-success").removeClass("hidden");g("#edusupport_screenshot input").removeClass("disabled");MAIN.screenshot=i.result;console.log(i.result)};i.onerror=function(k){g("#edusupport_screenshot div.alert-danger").removeClass("hidden");g("#edusupport_screenshot input").removeClass("disabled");console.log("Error: ",k,j)}}},}});
=======
define ("local_edusupport/main",["jquery","core/ajax","core/notification","core/str","core/url","core/modal_factory","core/modal_events","core/templates"],function(b,a,c,d,e,f,g){return{debug:1,modal:void 0,triggerSteps:0,assignSupporter:function assignSupporter(e){var h=this;console.log("ajax call");a.call([{methodname:"local_edusupport_get_potentialsupporters",args:{discussionid:e},done:function done(i){try{i=JSON.parse(i)}catch(a){}if(0<h.debug)console.log("local_edusupport_external:local_edusupport_get_potentialsupporters",i);var j=Object.keys(i.supporters),k="<input type=\"hidden\" value=\""+e+"\" />";k+="<select>";for(var l=0;l<j.length;l++){k+="<optgroup label=\""+j[l]+"\">";for(var m=0,n;m<i.supporters[j[l]].length;m++){n=i.supporters[j[l]][m];k+="<option value=\""+n.userid+"\""+(n.selected?" selected=\"selected\"":"")+">"+n.firstname+" "+n.lastname+"</option>"}k+="</optgroup>"}k+="</select>";f.create({title:d.get_string("select","core"),type:f.types.SAVE_CANCEL,body:k}).done(function(d){console.log("Created modal");d.show();d.getRoot().on(g.save,function(d){d.preventDefault();var e=b(this).find(".modal-body input").val(),f=b(this).find(".modal-body select").val();a.call([{methodname:"local_edusupport_set_currentsupporter",args:{discussionid:e,supporterid:f},done:function done(a){console.log(a);if(1==a){top.location.reload()}else{alert("Error: "+a)}},fail:c.exception}])})})},fail:c.exception}])},checkHasScreenshot:function checkHasScreenshot(a){var c=this;if(0<c.debug)console.log("local_edusupport/main:checkHasScreenshot(c)",a);if(""==b(a).closest("form").find("#screenshot").attr("src")){b(a).closest("form").find("#screenshot_ok").css("display","block")}else{b(a).closest("form").find("#screenshot_ok").css("display","none");b(a).closest("form").find("#screenshot").css("display",b(a).is(":checked")?"inline":"none");b(a).closest("form").find("#screenshot_new").css("display",b(a).is(":checked")?"block":"none")}},generateScreenshot:function generateScreenshot(a){MAIN.modal.hide();require(["local_edusupport/html2canvas"],function(b){console.log("Making screenshot");b(document.body).then(function(b){console.log("Got screenshot");MAIN.canvas=b;if("undefined"!=typeof MAIN.modal){MAIN.prepareScreenshot(a);MAIN.modal.show()}})})},injectHelpButton:function injectHelpButton(){console.log("local_edusupport/main:injectHelpButton()");a.call([{methodname:"local_edusupport_get_extralinks",args:{},done:function done(a){b(a).insertBefore(b(".nav .nav-item:last-child"))},fail:c.exception}]);this.colorize()},injectReplyButtons:function injectReplyButtons(a){d.get_strings([{key:"reply",component:"forum"}]).done(function(c){b("a[href*=\"issue.php?discussion="+a+"&parent=\"]").remove();b("a[href*=\"issue.php?discussion="+a+"&delete=\"]").remove();b("a[href*=\"post.php?prune=\"]").remove();b(".forum-post-container>.forumpost").each(function(){var d=b(this).attr("data-post-id");if(0==b(this).find(".reply-"+d).length){b(this).find(".post-actions:first-child").append(b("<a data-region=\"post-action\" class=\"btn btn-link reply-"+d+"\" title=\""+c[0]+"\" aria-label=\""+c[0]+"\" role=\"menuitem\" tabindex=\"-1\">").html(c[0]).attr("href",e.relativeUrl("/local/edusupport/issue.php?discussion="+a+"&replyto="+d)))}})}).fail(c.exception)},closeIssue:function closeIssue(b){console.log("closeIssue(discussionid)",b);a.call([{methodname:"local_edusupport_close_issue",args:{discussionid:b},done:function done(a){console.log(a);if(1==a){top.location.href=e.relativeUrl("/local/edusupport/issues.php",{})}else{c.exception(a)}},fail:c.exception}])},colorize:function colorize(){var e=[];b("table.forumheaderlist tr.discussion td.starter a").each(function(){var a=b(this).attr("href").split("?d=");e[e.length]=a[1]});var f={discussionids:e};console.log("local_edusupport_colorize",f);a.call([{methodname:"local_edusupport_colorize",args:f,done:function done(c){try{c=JSON.parse(c)}catch(a){}console.log(c);if("undefined"!=typeof c.styles){for(var d=Object.keys(c.styles),e=0;e<d.length;e++){var f=d[e],g=c.styles[f];b("table.forumheaderlist tr.discussion td.starter a[href$=\"d="+f+"\"]").closest("tr").attr("style",g)}}},fail:c.exception}])},faqtoogle:function faqtoogle(){if(b("input#id_faqread").length){b("#create_issue_input").toggle();b("#local_edusupport_create_form .fdescription.required").toggle();b("input#id_faqread").click(function(){b("#create_issue_input").toggle();b("#local_edusupport_create_form .fdescription.required").toggle()})}},injectForwardButton:function injectForwardButton(a,e){if(this.debug)console.log("local_edusupport/main:injectForwardButton(discussionid, isissue)",a,e);if("undefined"==typeof a)return;d.get_strings([{key:"undefined"!=typeof e&&e?"issue_revoke":"issue_assign_nextlevel",component:"local_edusupport"}]).done(function(c){b("#page-content div[role=\"main\"] .discussionname").parent().prepend(b("<a href=\"#\">").attr("onclick","require(['local_edusupport/main'], function(MAIN) { MAIN.injectForwardModal("+a+", "+e+"); }); return false;").attr("style","float: right").addClass("btn btn-secondary").html(c[0]))}).fail(c.exception)},injectTest:function injectTest(){var a=b(".discussionname");if("! "==a.text().substr(0,2)){a.addClass("alert-warning")}if("!!"==a.text().substr(0,2)){a.addClass("alert-danger")}},injectForwardModal:function injectForwardModal(a,b){d.get_strings([{key:"confirm",component:"core"},{key:"undefined"!=typeof b&&b?"issue_revoke":"issue_assign_nextlevel",component:"local_edusupport"}]).done(function(c){f.create({type:f.types.SAVE_CANCEL,title:c[0],body:c[1]}).done(function(c){var d=c.getRoot();d.on(g.save,function(){top.location.href=e.relativeUrl("/local/edusupport/forward_2nd_level.php",{d:a,revoke:b})});c.show()})}).fail(c.exception)},postBox:function postBox(f){var g=this;if("undefined"!=typeof g.is_sending&&g.is_sending){console.log("Issue in queue, aborting");return}if(0<g.debug)console.log("MAIN.postBox(modal)",f);var h=b("#local_edusupport_create_form #id_subject").val(),i=b("#local_edusupport_create_form #id_contactphone").val()||"";console.log(i);var j=b("#local_edusupport_create_form #id_description").val(),k=b("#local_edusupport_create_form #id_forum_group").val(),l=b("#local_edusupport_create_form #id_postto2ndlevel").prop("checked")?1:0,m=b("#local_edusupport_create_form #id_postscreenshot").prop("checked")?1:0,n=b("#local_edusupport_create_form img#screenshot").attr("src"),o=b("#local_edusupport_create_form #id_faqread").prop("checked")?1:0,p=top.location.href;if(0==o){var q=d.get_string("faqread","local_edusupport",{});b.when(q).done(function(a){c.alert("",a)});return}if(3>h.length||5>j.length){var q=d.get_string("be_more_accurate","local_edusupport",{});b.when(q).done(function(a){c.alert("",a)});return}g.is_sending=!0;var r=m&&"undefined"!=typeof n?n:"";if(0<g.debug)console.log("local_edusupport_create_issue",{subject:h,description:j,forum_group:k,postto2ndlevel:l,image:r,url:p});a.call([{methodname:"local_edusupport_create_issue",args:{subject:h,description:j,forum_group:k,postto2ndlevel:l,image:r,url:p,contactphone:i},done:function done(a){if(0<g.debug)console.log(a);f.hide();var b="";if("undefined"!=typeof a.responsibles){b+="<ul>";for(var h=0,j;h<a.responsibles.length;h++){j=a.responsibles[h];if("undefined"!=typeof j.userid&&0<j.userid){b+="<li><a href=\""+e.fileUrl("/user","view.php?id="+j.userid)+"\" target=\"_blank\">"+j.name+"</a></li>"}else if("undefined"!=typeof j.email&&""!=j.email){b+="<li><a href=\"mailto:"+j.email+"\">"+j.name+"</a></li>"}else{b+="<li>"+j.name+"</li>"}}b+="</ul>"}if("undefined"!=typeof a.discussionid&&-999==parseInt(a.discussionid)){d.get_strings([{key:"create_issue_success_title",component:"local_edusupport"},{key:"create_issue_success_description_mail",component:"local_edusupport"},{key:"create_issue_success_responsibles",component:"local_edusupport"},{key:"create_issue_success_close",component:"local_edusupport"}]).done(function(a){var d=a[1];if(""!=b){d=a[2]+b}c.alert(a[0],d,a[3])}).fail(c.exception)}else if("undefined"!=typeof a.discussionid&&0<parseInt(a.discussionid)){d.get_strings([{key:"create_issue_success_title",component:"local_edusupport"},{key:"create_issue_success_description",component:"local_edusupport"},{key:"create_issue_success_responsibles",component:"local_edusupport"},{key:"create_issue_success_goto",component:"local_edusupport"},{key:"create_issue_success_close",component:"local_edusupport"}]).done(function(d){var f=d[1];if(""!=b){f=d[2]+b}c.confirm(d[0],f,d[3],d[4],function(){top.location.href=e.fileUrl("/mod/forum","discuss.php?d="+a.discussionid)})}).fail(c.exception)}else{d.get_strings([{key:"create_issue_error_title",component:"local_edusupport"},{key:"create_issue_error_description",component:"local_edusupport"}]).done(function(a){c.alert(a[0],a[1])}).fail(c.exception)}g.is_sending=!1},fail:c.exception}])},prepareBox:function prepareBox(){var a=this;if(0<a.debug)console.log("Showing modal");var c=b(a.modal.body);if(1>=c.find("#id_forum_group>option").length){c.find("#id_forum_group").parent().parent().css("display","none")}a.modal.setLarge();a.modal.getRoot().on(g.save,function(b){a.postBox(a.modal);b.preventDefault()});var e=d.get_string("create_issue","local_edusupport",{});b.when(e).done(function(b){a.modal.setSaveButtonText(b)});a.modal.show()},prepareScreenshot:function prepareScreenshot(){var a=this,c=a.canvas.toDataURL(),d=b(a.modal.body);d.find("img#screenshot").attr("src",c);b("#screenshot").closest("div").css("display",void 0);b("#id_postscreenshot").closest("div.fitem").css("display",void 0);a.checkHasScreenshot(b("#id_postscreenshot"));delete a.canvas},showBox:function showBox(d){if("undefined"==typeof d)d=0;var e=this;delete e.canvas;if("undefined"!=typeof e.modal){e.prepareBox(d)}else{console.log("Fetching modal");e.triggerSpinner(1);a.call([{methodname:"local_edusupport_create_form",args:{url:top.location.href,image:"",forumid:d},done:function done(a){console.log("Got modal");e.triggerSpinner(-1);b("#local_edusupport_create_form").remove();f.create({type:f.types.SAVE_CANCEL,body:a,large:1}).done(function(a){console.log("Created modal");e.modal=a;e.prepareBox();e.faqtoogle()})},fail:c.exception}])}},showSupporter:function showSupporter(d){if("undefined"==typeof d)d=0;var e=this;delete e.canvas;if("undefined"!=typeof e.modal){e.prepareBox(d)}else{console.log("Fetching modal");e.triggerSpinner(1);a.call([{methodname:"local_edusupport_create_form",args:{url:top.location.href,image:"",forumid:d},done:function done(a){console.log("Got modal");e.triggerSpinner(-1);b("#local_edusupport_create_form").remove();f.create({type:f.types.SAVE_CANCEL,body:a,large:1}).done(function(a){console.log("Created modal");e.modal=a;e.prepareBox()})},fail:c.exception}])}},supportCourseMovedAlert:function supportCourseMovedAlert(a,b){f.create({title:a,type:f.types.OK,body:b}).done(function(a){a.show()})},triggerSpinner:function triggerSpinner(a){MAIN=this;MAIN.triggerSteps+=a;if(0<MAIN.triggerSteps){if(0==b("body #edusupport-spinner").length){b("body").append(b("<div id=\"edusupport-spinner\" class=\"spinner-grid show\"><div></div><div></div><div></div><div></div></div>"))}}else{b("#edusupport-spinner").remove()}}}});
=======
define ("local_edusupport/main",["jquery","core/ajax","core/notification","core/str","core/url","core/modal_factory","core/modal_events","core/templates"],function(b,a,c,d,e,f,g){return{debug:1,modal:void 0,triggerSteps:0,assignSupporter:function assignSupporter(e){var h=this;console.log("ajax call");a.call([{methodname:"local_edusupport_get_potentialsupporters",args:{discussionid:e},done:function done(i){try{i=JSON.parse(i)}catch(a){}if(0<h.debug)console.log("local_edusupport_external:local_edusupport_get_potentialsupporters",i);var j=Object.keys(i.supporters),k="<input type=\"hidden\" value=\""+e+"\" />";k+="<select>";for(var l=0;l<j.length;l++){k+="<optgroup label=\""+j[l]+"\">";for(var m=0,n;m<i.supporters[j[l]].length;m++){n=i.supporters[j[l]][m];k+="<option value=\""+n.userid+"\""+(n.selected?" selected=\"selected\"":"")+">"+n.firstname+" "+n.lastname+"</option>"}k+="</optgroup>"}k+="</select>";f.create({title:d.get_string("select","core"),type:f.types.SAVE_CANCEL,body:k}).done(function(d){console.log("Created modal");d.show();d.getRoot().on(g.save,function(d){d.preventDefault();var e=b(this).find(".modal-body input").val(),f=b(this).find(".modal-body select").val();a.call([{methodname:"local_edusupport_set_currentsupporter",args:{discussionid:e,supporterid:f},done:function done(a){console.log(a);if(1==a){top.location.reload()}else{alert("Error: "+a)}},fail:c.exception}])})})},fail:c.exception}])},checkHasScreenshot:function checkHasScreenshot(a){var c=this;if(0<c.debug)console.log("local_edusupport/main:checkHasScreenshot(c)",a);if(""==b(a).closest("form").find("#screenshot").attr("src")){b(a).closest("form").find("#screenshot_ok").css("display","block")}else{b(a).closest("form").find("#screenshot_ok").css("display","none");b(a).closest("form").find("#screenshot").css("display",b(a).is(":checked")?"inline":"none");b(a).closest("form").find("#screenshot_new").css("display",b(a).is(":checked")?"block":"none")}},generateScreenshot:function generateScreenshot(a){MAIN.modal.hide();require(["local_edusupport/html2canvas"],function(b){console.log("Making screenshot");b(document.body).then(function(b){console.log("Got screenshot");MAIN.canvas=b;if("undefined"!=typeof MAIN.modal){MAIN.prepareScreenshot(a);MAIN.modal.show()}})})},injectHelpButton:function injectHelpButton(){console.log("local_edusupport/main:injectHelpButton()");a.call([{methodname:"local_edusupport_get_extralinks",args:{},done:function done(a){b(a).insertBefore(b("nav[aria-label='Site navigation'] .nav .nav-item:last-child"))},fail:c.exception}]);this.colorize()},injectReplyButtons:function injectReplyButtons(a){d.get_strings([{key:"reply",component:"forum"}]).done(function(c){b("a[href*=\"issue.php?discussion="+a+"&parent=\"]").remove();b("a[href*=\"issue.php?discussion="+a+"&delete=\"]").remove();b("a[href*=\"post.php?prune=\"]").remove();b(".forum-post-container>.forumpost").each(function(){var d=b(this).attr("data-post-id");if(0==b(this).find(".reply-"+d).length){b(this).find(".post-actions:first-child").append(b("<a data-region=\"post-action\" class=\"btn btn-link reply-"+d+"\" title=\""+c[0]+"\" aria-label=\""+c[0]+"\" role=\"menuitem\" tabindex=\"-1\">").html(c[0]).attr("href",e.relativeUrl("/local/edusupport/issue.php?discussion="+a+"&replyto="+d)))}})}).fail(c.exception)},closeIssue:function closeIssue(b){console.log("closeIssue(discussionid)",b);a.call([{methodname:"local_edusupport_close_issue",args:{discussionid:b},done:function done(a){console.log(a);if(1==a){top.location.href=e.relativeUrl("/local/edusupport/issues.php",{})}else{c.exception(a)}},fail:c.exception}])},colorize:function colorize(){var e=[];b("table.forumheaderlist tr.discussion td.starter a").each(function(){var a=b(this).attr("href").split("?d=");e[e.length]=a[1]});var f={discussionids:e};console.log("local_edusupport_colorize",f);a.call([{methodname:"local_edusupport_colorize",args:f,done:function done(c){try{c=JSON.parse(c)}catch(a){}console.log(c);if("undefined"!=typeof c.styles){for(var d=Object.keys(c.styles),e=0;e<d.length;e++){var f=d[e],g=c.styles[f];b("table.forumheaderlist tr.discussion td.starter a[href$=\"d="+f+"\"]").closest("tr").attr("style",g)}}},fail:c.exception}])},faqtoogle:function faqtoogle(){if(b("input#id_faqread").length){b("#create_issue_input").toggle();b("#local_edusupport_create_form .fdescription.required").toggle();b("input#id_faqread").click(function(){b("#create_issue_input").toggle();b("#local_edusupport_create_form .fdescription.required").toggle()})}},injectForwardButton:function injectForwardButton(a,e){if(this.debug)console.log("local_edusupport/main:injectForwardButton(discussionid, isissue)",a,e);if("undefined"==typeof a)return;d.get_strings([{key:"undefined"!=typeof e&&e?"issue_revoke":"issue_assign_nextlevel",component:"local_edusupport"}]).done(function(c){b("#page-content div[role=\"main\"] .discussionname").parent().prepend(b("<a href=\"#\">").attr("onclick","require(['local_edusupport/main'], function(MAIN) { MAIN.injectForwardModal("+a+", "+e+"); }); return false;").attr("style","float: right").addClass("btn btn-secondary").html(c[0]))}).fail(c.exception)},injectTest:function injectTest(){var a=b(".discussionname");if("! "==a.text().substr(0,2)){a.addClass("alert-warning")}if("!!"==a.text().substr(0,2)){a.addClass("alert-danger")}},injectForwardModal:function injectForwardModal(a,b){d.get_strings([{key:"confirm",component:"core"},{key:"undefined"!=typeof b&&b?"issue_revoke":"issue_assign_nextlevel",component:"local_edusupport"}]).done(function(c){f.create({type:f.types.SAVE_CANCEL,title:c[0],body:c[1]}).done(function(c){var d=c.getRoot();d.on(g.save,function(){top.location.href=e.relativeUrl("/local/edusupport/forward_2nd_level.php",{d:a,revoke:b})});c.show()})}).fail(c.exception)},postBox:function postBox(f){var g=this;if("undefined"!=typeof g.is_sending&&g.is_sending){console.log("Issue in queue, aborting");return}if(0<g.debug)console.log("MAIN.postBox(modal)",f);var h=b("#local_edusupport_create_form #id_subject").val(),i=b("#local_edusupport_create_form #id_contactphone").val()||"";console.log(i);var j=b("#local_edusupport_create_form #id_description").val(),k=b("#local_edusupport_create_form #id_forum_group").val(),l=b("#local_edusupport_create_form #id_postto2ndlevel").prop("checked")?1:0,m=b("#local_edusupport_create_form #id_postscreenshot").prop("checked")?1:0,n=b("#local_edusupport_create_form img#screenshot").attr("src"),o=b("#local_edusupport_create_form #id_faqread").prop("checked")?1:0,p=top.location.href;if(0==o){var q=d.get_string("faqread","local_edusupport",{});b.when(q).done(function(a){c.alert("",a)});return}if(3>h.length||5>j.length){var q=d.get_string("be_more_accurate","local_edusupport",{});b.when(q).done(function(a){c.alert("",a)});return}g.is_sending=!0;var r=m&&"undefined"!=typeof n?n:"";if(0<g.debug)console.log("local_edusupport_create_issue",{subject:h,description:j,forum_group:k,postto2ndlevel:l,image:r,url:p});a.call([{methodname:"local_edusupport_create_issue",args:{subject:h,description:j,forum_group:k,postto2ndlevel:l,image:r,url:p,contactphone:i},done:function done(a){if(0<g.debug)console.log(a);f.hide();var b="";if("undefined"!=typeof a.responsibles){b+="<ul>";for(var h=0,j;h<a.responsibles.length;h++){j=a.responsibles[h];if("undefined"!=typeof j.userid&&0<j.userid){b+="<li><a href=\""+e.fileUrl("/user","view.php?id="+j.userid)+"\" target=\"_blank\">"+j.name+"</a></li>"}else if("undefined"!=typeof j.email&&""!=j.email){b+="<li><a href=\"mailto:"+j.email+"\">"+j.name+"</a></li>"}else{b+="<li>"+j.name+"</li>"}}b+="</ul>"}if("undefined"!=typeof a.discussionid&&-999==parseInt(a.discussionid)){d.get_strings([{key:"create_issue_success_title",component:"local_edusupport"},{key:"create_issue_success_description_mail",component:"local_edusupport"},{key:"create_issue_success_responsibles",component:"local_edusupport"},{key:"create_issue_success_close",component:"local_edusupport"}]).done(function(a){var d=a[1];if(""!=b){d=a[2]+b}c.alert(a[0],d,a[3])}).fail(c.exception)}else if("undefined"!=typeof a.discussionid&&0<parseInt(a.discussionid)){d.get_strings([{key:"create_issue_success_title",component:"local_edusupport"},{key:"create_issue_success_description",component:"local_edusupport"},{key:"create_issue_success_responsibles",component:"local_edusupport"},{key:"create_issue_success_goto",component:"local_edusupport"},{key:"create_issue_success_close",component:"local_edusupport"}]).done(function(d){var f=d[1];if(""!=b){f=d[2]+b}c.confirm(d[0],f,d[3],d[4],function(){top.location.href=e.fileUrl("/mod/forum","discuss.php?d="+a.discussionid)})}).fail(c.exception)}else{d.get_strings([{key:"create_issue_error_title",component:"local_edusupport"},{key:"create_issue_error_description",component:"local_edusupport"}]).done(function(a){c.alert(a[0],a[1])}).fail(c.exception)}g.is_sending=!1},fail:c.exception}])},prepareBox:function prepareBox(){var a=this;if(0<a.debug)console.log("Showing modal");var c=b(a.modal.body);if(1>=c.find("#id_forum_group>option").length){c.find("#id_forum_group").parent().parent().css("display","none")}a.modal.setLarge();a.modal.getRoot().on(g.save,function(b){a.postBox(a.modal);b.preventDefault()});var e=d.get_string("create_issue","local_edusupport",{});b.when(e).done(function(b){a.modal.setSaveButtonText(b)});a.modal.show()},prepareScreenshot:function prepareScreenshot(){var a=this,c=a.canvas.toDataURL(),d=b(a.modal.body);d.find("img#screenshot").attr("src",c);b("#screenshot").closest("div").css("display",void 0);b("#id_postscreenshot").closest("div.fitem").css("display",void 0);a.checkHasScreenshot(b("#id_postscreenshot"));delete a.canvas},showBox:function showBox(d){if("undefined"==typeof d)d=0;var e=this;delete e.canvas;if("undefined"!=typeof e.modal){e.prepareBox(d)}else{console.log("Fetching modal");e.triggerSpinner(1);a.call([{methodname:"local_edusupport_create_form",args:{url:top.location.href,image:"",forumid:d},done:function done(a){console.log("Got modal");e.triggerSpinner(-1);b("#local_edusupport_create_form").remove();f.create({type:f.types.SAVE_CANCEL,body:a,large:1}).done(function(a){console.log("Created modal");e.modal=a;e.prepareBox();e.faqtoogle()})},fail:c.exception}])}},showSupporter:function showSupporter(d){if("undefined"==typeof d)d=0;var e=this;delete e.canvas;if("undefined"!=typeof e.modal){e.prepareBox(d)}else{console.log("Fetching modal");e.triggerSpinner(1);a.call([{methodname:"local_edusupport_create_form",args:{url:top.location.href,image:"",forumid:d},done:function done(a){console.log("Got modal");e.triggerSpinner(-1);b("#local_edusupport_create_form").remove();f.create({type:f.types.SAVE_CANCEL,body:a,large:1}).done(function(a){console.log("Created modal");e.modal=a;e.prepareBox()})},fail:c.exception}])}},supportCourseMovedAlert:function supportCourseMovedAlert(a,b){f.create({title:a,type:f.types.OK,body:b}).done(function(a){a.show()})},triggerSpinner:function triggerSpinner(a){MAIN=this;MAIN.triggerSteps+=a;if(0<MAIN.triggerSteps){if(0==b("body #edusupport-spinner").length){b("body").append(b("<div id=\"edusupport-spinner\" class=\"spinner-grid show\"><div></div><div></div><div></div><div></div></div>"))}}else{b("#edusupport-spinner").remove()}}}});
>>>>>>> fixed #Icon injection: wrong place #4
=======
define ("local_edusupport/main",["jquery","core/ajax","core/notification","core/str","core/url","core/modal_factory","core/modal_events","core/templates"],function(b,a,c,d,e,f,g){return{debug:1,modal:void 0,triggerSteps:0,assignSupporter:function assignSupporter(e){var h=this;console.log("ajax call");a.call([{methodname:"local_edusupport_get_potentialsupporters",args:{discussionid:e},done:function done(i){try{i=JSON.parse(i)}catch(a){}if(0<h.debug)console.log("local_edusupport_external:local_edusupport_get_potentialsupporters",i);var j=Object.keys(i.supporters),k="<input type=\"hidden\" value=\""+e+"\" />";k+="<select>";for(var l=0;l<j.length;l++){k+="<optgroup label=\""+j[l]+"\">";for(var m=0,n;m<i.supporters[j[l]].length;m++){n=i.supporters[j[l]][m];k+="<option value=\""+n.userid+"\""+(n.selected?" selected=\"selected\"":"")+">"+n.firstname+" "+n.lastname+"</option>"}k+="</optgroup>"}k+="</select>";f.create({title:d.get_string("select","core"),type:f.types.SAVE_CANCEL,body:k}).done(function(d){console.log("Created modal");d.show();d.getRoot().on(g.save,function(d){d.preventDefault();var e=b(this).find(".modal-body input").val(),f=b(this).find(".modal-body select").val();a.call([{methodname:"local_edusupport_set_currentsupporter",args:{discussionid:e,supporterid:f},done:function done(a){console.log(a);if(1==a){top.location.reload()}else{alert("Error: "+a)}},fail:c.exception}])})})},fail:c.exception}])},checkHasScreenshot:function checkHasScreenshot(a){var c=this;if(0<c.debug)console.log("local_edusupport/main:checkHasScreenshot(c)",a);if(""==b(a).closest("form").find("#screenshot").attr("src")){b(a).closest("form").find("#screenshot_ok").css("display","block")}else{b(a).closest("form").find("#screenshot_ok").css("display","none");b(a).closest("form").find("#screenshot").css("display",b(a).is(":checked")?"inline":"none");b(a).closest("form").find("#screenshot_new").css("display",b(a).is(":checked")?"block":"none")}},generateScreenshot:function generateScreenshot(a){MAIN.modal.hide();require(["local_edusupport/html2canvas"],function(b){console.log("Making screenshot");b(document.body).then(function(b){console.log("Got screenshot");MAIN.canvas=b;if("undefined"!=typeof MAIN.modal){MAIN.prepareScreenshot(a);MAIN.modal.show()}})})},injectHelpButton:function injectHelpButton(){console.log("local_edusupport/main:injectHelpButton()");a.call([{methodname:"local_edusupport_get_extralinks",args:{},done:function done(a){b(a).insertBefore(b("nav.fixed-top .nav .nav-item:last-child"))},fail:c.exception}]);this.colorize()},injectReplyButtons:function injectReplyButtons(a){d.get_strings([{key:"reply",component:"forum"}]).done(function(c){b("a[href*=\"issue.php?discussion="+a+"&parent=\"]").remove();b("a[href*=\"issue.php?discussion="+a+"&delete=\"]").remove();b("a[href*=\"post.php?prune=\"]").remove();b(".forum-post-container>.forumpost").each(function(){var d=b(this).attr("data-post-id");if(0==b(this).find(".reply-"+d).length){b(this).find(".post-actions:first-child").append(b("<a data-region=\"post-action\" class=\"btn btn-link reply-"+d+"\" title=\""+c[0]+"\" aria-label=\""+c[0]+"\" role=\"menuitem\" tabindex=\"-1\">").html(c[0]).attr("href",e.relativeUrl("/local/edusupport/issue.php?discussion="+a+"&replyto="+d)))}})}).fail(c.exception)},closeIssue:function closeIssue(b){console.log("closeIssue(discussionid)",b);a.call([{methodname:"local_edusupport_close_issue",args:{discussionid:b},done:function done(a){console.log(a);if(1==a){top.location.href=e.relativeUrl("/local/edusupport/issues.php",{})}else{c.exception(a)}},fail:c.exception}])},colorize:function colorize(){var e=[];b("table.forumheaderlist tr.discussion td.starter a").each(function(){var a=b(this).attr("href").split("?d=");e[e.length]=a[1]});var f={discussionids:e};console.log("local_edusupport_colorize",f);a.call([{methodname:"local_edusupport_colorize",args:f,done:function done(c){try{c=JSON.parse(c)}catch(a){}console.log(c);if("undefined"!=typeof c.styles){for(var d=Object.keys(c.styles),e=0;e<d.length;e++){var f=d[e],g=c.styles[f];b("table.forumheaderlist tr.discussion td.starter a[href$=\"d="+f+"\"]").closest("tr").attr("style",g)}}},fail:c.exception}])},faqtoogle:function faqtoogle(){if(b("input#id_faqread").length){b("#create_issue_input").toggle();b("#local_edusupport_create_form .fdescription.required").toggle();b("input#id_faqread").click(function(){b("#create_issue_input").toggle();b("#local_edusupport_create_form .fdescription.required").toggle()})}},injectForwardButton:function injectForwardButton(a,e){if(this.debug)console.log("local_edusupport/main:injectForwardButton(discussionid, isissue)",a,e);if("undefined"==typeof a)return;d.get_strings([{key:"undefined"!=typeof e&&e?"issue_revoke":"issue_assign_nextlevel",component:"local_edusupport"}]).done(function(c){b("#page-content div[role=\"main\"] .discussionname").parent().prepend(b("<a href=\"#\">").attr("onclick","require(['local_edusupport/main'], function(MAIN) { MAIN.injectForwardModal("+a+", "+e+"); }); return false;").attr("style","float: right").addClass("btn btn-secondary").html(c[0]))}).fail(c.exception)},injectTest:function injectTest(){var a=b(".discussionname");if("! "==a.text().substr(0,2)){a.addClass("alert-warning")}if("!!"==a.text().substr(0,2)){a.addClass("alert-danger")}},injectForwardModal:function injectForwardModal(a,b){d.get_strings([{key:"confirm",component:"core"},{key:"undefined"!=typeof b&&b?"issue_revoke":"issue_assign_nextlevel",component:"local_edusupport"}]).done(function(c){f.create({type:f.types.SAVE_CANCEL,title:c[0],body:c[1]}).done(function(c){var d=c.getRoot();d.on(g.save,function(){top.location.href=e.relativeUrl("/local/edusupport/forward_2nd_level.php",{d:a,revoke:b})});c.show()})}).fail(c.exception)},postBox:function postBox(f){var g=this;if("undefined"!=typeof g.is_sending&&g.is_sending){console.log("Issue in queue, aborting");return}if(0<g.debug)console.log("MAIN.postBox(modal)",f);var h=b("#local_edusupport_create_form #id_subject").val(),i=b("#local_edusupport_create_form #id_contactphone").val()||"";console.log(i);var j=b("#local_edusupport_create_form #id_description").val(),k=b("#local_edusupport_create_form #id_forum_group").val(),l=b("#local_edusupport_create_form #id_postto2ndlevel").prop("checked")?1:0,m=b("#local_edusupport_create_form #id_postscreenshot").prop("checked")?1:0,n=b("#local_edusupport_create_form img#screenshot").attr("src"),o=b("#local_edusupport_create_form #id_faqread").prop("checked")?1:0,p=top.location.href;if(0==o){var q=d.get_string("faqread","local_edusupport",{});b.when(q).done(function(a){c.alert("",a)});return}if(3>h.length||5>j.length){var q=d.get_string("be_more_accurate","local_edusupport",{});b.when(q).done(function(a){c.alert("",a)});return}g.is_sending=!0;var r=m&&"undefined"!=typeof n?n:"";if(0<g.debug)console.log("local_edusupport_create_issue",{subject:h,description:j,forum_group:k,postto2ndlevel:l,image:r,url:p});a.call([{methodname:"local_edusupport_create_issue",args:{subject:h,description:j,forum_group:k,postto2ndlevel:l,image:r,url:p,contactphone:i},done:function done(a){if(0<g.debug)console.log(a);f.hide();var b="";if("undefined"!=typeof a.responsibles){b+="<ul>";for(var h=0,j;h<a.responsibles.length;h++){j=a.responsibles[h];if("undefined"!=typeof j.userid&&0<j.userid){b+="<li><a href=\""+e.fileUrl("/user","view.php?id="+j.userid)+"\" target=\"_blank\">"+j.name+"</a></li>"}else if("undefined"!=typeof j.email&&""!=j.email){b+="<li><a href=\"mailto:"+j.email+"\">"+j.name+"</a></li>"}else{b+="<li>"+j.name+"</li>"}}b+="</ul>"}if("undefined"!=typeof a.discussionid&&-999==parseInt(a.discussionid)){d.get_strings([{key:"create_issue_success_title",component:"local_edusupport"},{key:"create_issue_success_description_mail",component:"local_edusupport"},{key:"create_issue_success_responsibles",component:"local_edusupport"},{key:"create_issue_success_close",component:"local_edusupport"}]).done(function(a){var d=a[1];if(""!=b){d=a[2]+b}c.alert(a[0],d,a[3])}).fail(c.exception)}else if("undefined"!=typeof a.discussionid&&0<parseInt(a.discussionid)){d.get_strings([{key:"create_issue_success_title",component:"local_edusupport"},{key:"create_issue_success_description",component:"local_edusupport"},{key:"create_issue_success_responsibles",component:"local_edusupport"},{key:"create_issue_success_goto",component:"local_edusupport"},{key:"create_issue_success_close",component:"local_edusupport"}]).done(function(d){var f=d[1];if(""!=b){f=d[2]+b}c.confirm(d[0],f,d[3],d[4],function(){top.location.href=e.fileUrl("/mod/forum","discuss.php?d="+a.discussionid)})}).fail(c.exception)}else{d.get_strings([{key:"create_issue_error_title",component:"local_edusupport"},{key:"create_issue_error_description",component:"local_edusupport"}]).done(function(a){c.alert(a[0],a[1])}).fail(c.exception)}g.is_sending=!1},fail:c.exception}])},prepareBox:function prepareBox(){var a=this;if(0<a.debug)console.log("Showing modal");var c=b(a.modal.body);if(1>=c.find("#id_forum_group>option").length){c.find("#id_forum_group").parent().parent().css("display","none")}a.modal.setLarge();a.modal.getRoot().on(g.save,function(b){a.postBox(a.modal);b.preventDefault()});var e=d.get_string("create_issue","local_edusupport",{});b.when(e).done(function(b){a.modal.setSaveButtonText(b)});a.modal.show()},prepareScreenshot:function prepareScreenshot(){var a=this,c=a.canvas.toDataURL(),d=b(a.modal.body);d.find("img#screenshot").attr("src",c);b("#screenshot").closest("div").css("display",void 0);b("#id_postscreenshot").closest("div.fitem").css("display",void 0);a.checkHasScreenshot(b("#id_postscreenshot"));delete a.canvas},showBox:function showBox(d){if("undefined"==typeof d)d=0;var e=this;delete e.canvas;if("undefined"!=typeof e.modal){e.prepareBox(d)}else{console.log("Fetching modal");e.triggerSpinner(1);a.call([{methodname:"local_edusupport_create_form",args:{url:top.location.href,image:"",forumid:d},done:function done(a){console.log("Got modal");e.triggerSpinner(-1);b("#local_edusupport_create_form").remove();f.create({type:f.types.SAVE_CANCEL,body:a,large:1}).done(function(a){console.log("Created modal");e.modal=a;e.prepareBox();e.faqtoogle()})},fail:c.exception}])}},showSupporter:function showSupporter(d){if("undefined"==typeof d)d=0;var e=this;delete e.canvas;if("undefined"!=typeof e.modal){e.prepareBox(d)}else{console.log("Fetching modal");e.triggerSpinner(1);a.call([{methodname:"local_edusupport_create_form",args:{url:top.location.href,image:"",forumid:d},done:function done(a){console.log("Got modal");e.triggerSpinner(-1);b("#local_edusupport_create_form").remove();f.create({type:f.types.SAVE_CANCEL,body:a,large:1}).done(function(a){console.log("Created modal");e.modal=a;e.prepareBox()})},fail:c.exception}])}},supportCourseMovedAlert:function supportCourseMovedAlert(a,b){f.create({title:a,type:f.types.OK,body:b}).done(function(a){a.show()})},triggerSpinner:function triggerSpinner(a){MAIN=this;MAIN.triggerSteps+=a;if(0<MAIN.triggerSteps){if(0==b("body #edusupport-spinner").length){b("body").append(b("<div id=\"edusupport-spinner\" class=\"spinner-grid show\"><div></div><div></div><div></div><div></div></div>"))}}else{b("#edusupport-spinner").remove()}}}});
//# sourceMappingURL=main.min.js.map
