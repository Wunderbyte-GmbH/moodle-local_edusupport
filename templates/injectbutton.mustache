{{!
    This file is part of Moodle - http://moodle.org/

    Moodle is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Moodle is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
}}
{{!
   @template local_edusupport/injectbutton

   The purpose of this template is to render action buttons

   Classes required for JS:
   * none

   Data attributes required for JS:
   * none

   Context variables required for this template:
   * attributes Array of name / value pairs.

   Example context (json):
   {
       "options": [
       "title" => get_string('issue_assign', 'local_edusupport'),
       "class" => '',
       "icon" => '/pix/i/users.svg',
       "href" => '#',
       "onclick" => 'require(
           { "title": "a title" },
           { "class": "classnames" },
           { "icon": "an icon to use" },
           { "href": "the link href" },
           { "onclick": "onclick" },
       ]
   }
 }}

{{#js}}
require(['jquery'], function($) {
    var html = [
        {{#hasextralinks}}
            '<li class="dropdown nav-item local-edusupport-menu">',
            '    <a class="dropdown-toggle nav-link" id="drop-down-{{uniqid}}"',
            '        data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"',
            '        href="#" title="{{#str}} pluginname, local_edusupport {{/str}}"',
            '        aria-controls="drop-down-menu-{{uniqid}}" style="padding-right:0; padding-left:0;">',
            '        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false"  style=" width: 40px; -ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M21 12.22C21 6.73 16.74 3 12 3c-4.69 0-9 3.65-9 9.28c-.6.34-1 .98-1 1.72v2c0 1.1.9 2 2 2h1v-6.1c0-3.87 3.13-7 7-7s7 3.13 7 7V19h-8v2h8c1.1 0 2-.9 2-2v-1.22c.59-.31 1-.92 1-1.64v-2.3c0-.7-.41-1.31-1-1.62z"  fill="#2E3942" opacity="0.8"/><circle cx="9" cy="13" r="1"  fill="#2E3942" opacity="0.8"/><circle cx="15" cy="13" r="1"  fill="#2E3942" opacity="0.8"/><path d="M18 11.03A6.04 6.04 0 0 0 12.05 6c-3.03 0-6.29 2.51-6.03 6.45a8.075 8.075 0 0 0 4.86-5.89c1.31 2.63 4 4.44 7.12 4.47z"  fill="#2E3942" opacity="0.8"/></svg>',
            '    </a>',
            '    <div class="dropdown-menu dropdown-menu-right" role="menu" id="drop-down-menu-{{uniqid}}" aria-labelledby="drop-down-{{uniqid}}">',
            '        <a href="#"  class="dropdown-item menu-action" role="menuitem" data-title="{{#str}} create_issue, local_edusupport {{/str}}" aria-labelledby="actionmenuaction-{{uniqid}}-x"',
            '            onclick="require([\'local_edusupport/main\'], function(MAIN){ MAIN.showBox(); }); return false;">',
            '            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false"  style=" width: 40px; -ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M21 12.22C21 6.73 16.74 3 12 3c-4.69 0-9 3.65-9 9.28c-.6.34-1 .98-1 1.72v2c0 1.1.9 2 2 2h1v-6.1c0-3.87 3.13-7 7-7s7 3.13 7 7V19h-8v2h8c1.1 0 2-.9 2-2v-1.22c.59-.31 1-.92 1-1.64v-2.3c0-.7-.41-1.31-1-1.62z"  fill="#2E3942" opacity="0.8"/><circle cx="9" cy="13" r="1"  fill="#2E3942" opacity="0.8"/><circle cx="15" cy="13" r="1"  fill="#2E3942" opacity="0.8"/><path d="M18 11.03A6.04 6.04 0 0 0 12.05 6c-3.03 0-6.29 2.51-6.03 6.45a8.075 8.075 0 0 0 4.86-5.89c1.31 2.63 4 4.44 7.12 4.47z"  fill="#2E3942" opacity="0.8"/></svg>',
            '            <span class="menu-action-text" id="actionmenuaction-{{uniqid}}-x">',
            '                {{#str}} create_issue, local_edusupport {{/str}}',
            '            </span>',
            '        </a>',
            '        <div class="dropdown-divider" role="presentation"><span class="filler">&nbsp;</span></div>',
                     {{#extralinks}}
            '            <a href="{{url}}" {{#target}} target="{{target}}"{{/target}} class="dropdown-item menu-action" role="menuitem" data-title="{{name}}" aria-labelledby="actionmenuaction-{{uniqid}}-{{id}}">',
            '                {{#faicon}}',
            '                <i class="icon fa {{faicon}}"></i>',
            '                {{/faicon}}',
            '                <span class="menu-action-text" id="actionmenuaction-{{uniqid}}-{{id}}">',
            '                    {{name}}',
            '                </span>',
            '            </a>',
                    {{/extralinks}}
            '    </div>',
            '</li>',
        {{/hasextralinks}}
        {{^hasextralinks}}
            '<li class="nav-item">',
            '    <div class="popover-region popover-region-edusupport collapsed">',
            '        <a href="#" class="nav-link d-inline-block popover-region-toggle position-relative"',
            '            onclick="require([\'local_edusupport/main\'], function(MAIN){ MAIN.showBox(); }); return false;" style="padding-right:0; padding-left:0;">',
            '            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false"  style=" width: 40px; -ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M21 12.22C21 6.73 16.74 3 12 3c-4.69 0-9 3.65-9 9.28c-.6.34-1 .98-1 1.72v2c0 1.1.9 2 2 2h1v-6.1c0-3.87 3.13-7 7-7s7 3.13 7 7V19h-8v2h8c1.1 0 2-.9 2-2v-1.22c.59-.31 1-.92 1-1.64v-2.3c0-.7-.41-1.31-1-1.62z"  fill="#2E3942" opacity="0.8"/><circle cx="9" cy="13" r="1"  fill="#2E3942" opacity="0.8"/><circle cx="15" cy="13" r="1"  fill="#2E3942" opacity="0.8"/><path d="M18 11.03A6.04 6.04 0 0 0 12.05 6c-3.03 0-6.29 2.51-6.03 6.45a8.075 8.075 0 0 0 4.86-5.89c1.31 2.63 4 4.44 7.12 4.47z"  fill="#2E3942" opacity="0.8"/></svg>',
            '        </a>',
            '    </div>',
            '</li>',
        {{/hasextralinks}}
    ].join("\n");

    $(html).insertBefore($('.nav .usermenu'));
});
{{/js}}
